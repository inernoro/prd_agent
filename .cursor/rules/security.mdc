---
alwaysApply: true
---

# 安全约束

## 密钥与敏感信息

### 绝对禁止
- **禁止将密钥、密码、Token、证书内容写入仓库任何文件**
- 禁止在 commit message、PR 描述、日志中出现敏感信息

### 遇到敏感信息时
- 仅保留占位符示例（如 `your-api-key-here`、`***`）
- 提示用户将真实值迁移到环境变量或 GitHub Secrets
- 日志中敏感字段必须脱敏（如 `apiKey: ***`）

### 正确做法
- 敏感配置通过环境变量注入（如 `LLM__ClaudeApiKey`）
- 生产密钥存放于 CI/CD Secrets，不入仓库
- 本地开发使用 `.env.local`（已在 .gitignore）

## 数据安全

### 传输加密
- 所有 API 通信必须 HTTPS（TLS 1.2+）
- 客户端 WebView 限制外部资源加载（CSP）

### 会话隔离
- 不同用户/群组数据完全隔离
- 越权操作返回 `PERMISSION_DENIED`

## 日志脱敏

### 禁止记录
- API Key、密码、证书
- 个人身份信息（如手机号、身份证）

### 允许记录
- 请求 ID、用户 ID、时间戳
- 错误码、响应耗时
- Token 用量统计（数值，非内容）
