# AI ç«æŠ€åœº (AI Arena) - è®¾è®¡æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: v1.0 | **æ—¥æœŸ**: 2026-02-24 | **ä½ç½®**: å®éªŒå®¤ â†’ æ–°å¢ Tab

## 1. éœ€æ±‚æ¦‚è¿°

åœ¨å®éªŒå®¤ä¸­æ–°å¢"AI ç«æŠ€åœº"åŠŸèƒ½ï¼Œç”¨æˆ·è¾“å…¥ä¸€ä¸ªé—®é¢˜å**ä¸€é”®å‘é€åˆ°ç³»ç»Ÿä¸­æ‰€æœ‰å·²é…ç½®çš„é¡¶çº§ AI æ¨¡å‹**ï¼Œå®æ—¶å¹¶è¡Œè·å–æµå¼å“åº”ï¼Œåœ¨å¯è§†åŒ–é¢æ¿ä¸­æ¨ªå‘å¯¹æ¯”æ‰€æœ‰æ¨¡å‹çš„å›ç­”è´¨é‡ã€é€Ÿåº¦å’Œç‰¹ç‚¹ã€‚

### ä¸ç°æœ‰"å¤§æ¨¡å‹å®éªŒå®¤"çš„åŒºåˆ«

| ç»´åº¦ | å¤§æ¨¡å‹å®éªŒå®¤ (LlmLabTab) | AI ç«æŠ€åœº (ArenaLabTab) |
|------|------------------------|------------------------|
| **å®šä½** | ä¸“ä¸šæµ‹è¯•å·¥å…·ï¼ˆæµ‹é€Ÿ/æ„å›¾/æ ¼å¼ï¼‰ | ä¸€é”®å¯¹æ¯”ä½“éªŒå·¥å…· |
| **æ¨¡å‹é€‰æ‹©** | æ‰‹åŠ¨ä»æ¨¡å‹é€‰æ‹©å™¨é€ä¸€å‹¾é€‰ | é¢„è®¾åˆ†ç»„ + ä¸€é”®å…¨é€‰ |
| **å“åº”å±•ç¤º** | æ‘˜è¦é¢„è§ˆ + æ€§èƒ½æŒ‡æ ‡ä¸ºä¸» | **å®Œæ•´æµå¼æ–‡æœ¬å¹¶æ’å±•ç¤º** |
| **äº¤äº’** | å®éªŒé…ç½® â†’ è¿è¡Œ â†’ æŸ¥çœ‹ç»“æœ | è¾“å…¥é—®é¢˜ â†’ ä¸€é”®å‘é€ â†’ å®æ—¶é˜…è¯» |
| **ç›®æ ‡ç”¨æˆ·** | æ¨¡å‹è¿ç»´/è°ƒå‚äººå‘˜ | äº§å“/ä¸šåŠ¡/å¥½å¥‡å¿ƒé©±åŠ¨çš„æ‰€æœ‰äºº |

## 2. æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LabPage.tsx (æ–°å¢ç¬¬5ä¸ªTab)          â”‚
â”‚  [è¯•éªŒè½¦é—´] [å¤§æ¨¡å‹å®éªŒå®¤] [æ¡Œé¢å®éªŒå®¤] [ç‰¹æ•ˆå±•ç¤º] [AIç«æŠ€åœº] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    ArenaLabTab.tsx       â”‚
          â”‚  (æ–°é¡µé¢ç»„ä»¶)            â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                  â”‚                  â”‚
    â–¼                  â–¼                  â–¼
[é¢„è®¾åˆ†ç»„API]    [ModelLab RunStream]  [æ¨¡å‹åˆ—è¡¨API]
(æ–°å¢ç«¯ç‚¹)       (å¤ç”¨ç°æœ‰SSE)         (å¤ç”¨ç°æœ‰)
```

### æ ¸å¿ƒå†³ç­–ï¼šå¤ç”¨ ModelLabController

**ä¸æ–°å»º Controller**ã€‚åŸå› ï¼š

1. `ModelLabController` å·²å®ç°å®Œæ•´çš„å¤šæ¨¡å‹å¹¶è¡Œ SSE æµå¼å¯¹æ¯”é€»è¾‘
2. æ”¯æŒ `RepeatN`ã€å¹¶å‘æ§åˆ¶ã€TTFT/TotalMs ç»Ÿè®¡ã€delta æµå¼è½¬å‘
3. å‰ç«¯å·²æœ‰å®Œæ•´çš„ SSE è§£æå’Œäº‹ä»¶æ¶ˆè´¹æœºåˆ¶
4. AI ç«æŠ€åœºæœ¬è´¨æ˜¯"ç®€åŒ–å…¥å£ + å¢å¼ºå±•ç¤º"ï¼Œä¸æ˜¯æ–°ä¸šåŠ¡

åªéœ€åœ¨ `ModelLabController` ä¸Š**æ–°å¢ä¸€ä¸ªç«¯ç‚¹**è·å–é¢„è®¾åˆ†ç»„ï¼Œå‰ç«¯æ–°å¢ä¸€ä¸ª Tab ç»„ä»¶ã€‚

## 3. åç«¯è®¾è®¡

### 3.1 æ–°å¢ç«¯ç‚¹ï¼šé¢„è®¾åˆ†ç»„

```
GET /api/lab/model/arena-presets
```

**èŒè´£**ï¼šæ‰«æç³»ç»Ÿä¸­æ‰€æœ‰å·²å¯ç”¨çš„å¹³å°å’Œæ¨¡å‹ï¼ŒæŒ‰é¢„è®¾è§„åˆ™è‡ªåŠ¨åˆ†ç»„è¿”å›ã€‚

```csharp
// ModelLabController.cs æ–°å¢

[HttpGet("arena-presets")]
[ProducesResponseType(typeof(ApiResponse<object>), StatusCodes.Status200OK)]
public async Task<IActionResult> GetArenaPresets(CancellationToken ct)
{
    // 1. è·å–æ‰€æœ‰å·²å¯ç”¨å¹³å°
    var platforms = await _db.LLMPlatforms
        .Find(p => p.Enabled)
        .ToListAsync(ct);

    // 2. è·å–æ‰€æœ‰å·²å¯ç”¨çš„ chat ç±»å‹æ¨¡å‹
    var models = await _db.LLMModels
        .Find(m => m.Enabled)
        .ToListAsync(ct);

    // 3. åŒæ—¶æ”¶é›†å¹³å°ä¸Šæœªåœ¨ llm_models ä¸­æ³¨å†Œä½†å¯ç›´æ¥è°ƒç”¨çš„æ¨¡å‹
    //    (å³å¹³å°å·²é…ç½® API Keyï¼Œå¯ä»¥ç”¨ä»»æ„ modelName è°ƒç”¨çš„æƒ…å†µ)

    // 4. æŒ‰è§„åˆ™åˆ†ç»„
    var presets = BuildArenaPresets(platforms, models);
    return Ok(ApiResponse<object>.Ok(new { presets }));
}
```

**åˆ†ç»„è§„åˆ™**ï¼š

| é¢„è®¾ Key | åç§° | åŒ¹é…è§„åˆ™ |
|----------|------|---------|
| `all` | å…¨éƒ¨æ¨¡å‹ | æ‰€æœ‰å·²å¯ç”¨çš„ chat æ¨¡å‹ |
| `global-frontier` | å…¨çƒå‰æ²¿ | å¹³å°ç±»å‹å« openai/anthropic/googleï¼Œæˆ–æ¨¡å‹åå« gpt/claude/gemini |
| `china-frontier` | å›½äº§å‰æ²¿ | å¹³å°å/æ¨¡å‹åå« deepseek/qwen/doubao/glm/moonshot/yi/baichuan |
| `reasoning` | æ¨ç†ä¸“ç²¾ | æ¨¡å‹åå« o1/o3/r1/qwq/deepseek-r ç­‰æ¨ç†æ¨¡å‹æ ‡è¯† |
| `cost-effective` | æ€§ä»·æ¯” | æ¨¡å‹åå« mini/flash/lite/haiku/turbo ç­‰è½»é‡æ ‡è¯† |

**è¿”å›ç»“æ„**ï¼š

```typescript
interface ArenaPreset {
  key: string;           // é¢„è®¾æ ‡è¯†
  name: string;          // æ˜¾ç¤ºåç§°
  description: string;   // æè¿°ï¼ˆåŒ…å«æ¨¡å‹æ•°é‡ï¼‰
  models: ArenaModel[];  // æ¨¡å‹åˆ—è¡¨
  count: number;         // æ¨¡å‹æ•°é‡
}

interface ArenaModel {
  platformId: string;
  platformName: string;
  modelId: string;       // å³ modelNameï¼ˆå¹³å°ä¾§IDï¼‰
  displayName: string;   // å±•ç¤ºåç§°
  tags: string[];        // æ ‡ç­¾: ["reasoning", "global", "frontier"]
}
```

### 3.2 AppCallerCode æ³¨å†Œ

åœ¨ `AppCallerRegistry.cs` çš„ `Admin` ç±»ä¸­æ–°å¢ï¼š

```csharp
public static class Arena
{
    [AppCallerMetadata(
        displayName: "AIç«æŠ€åœº-å…¨çƒé—®ç­”",
        description: "AIç«æŠ€åœºä¸€é”®è¯¢é—®æ‰€æœ‰æ¨¡å‹",
        ModelTypes: new[] { ModelTypes.Chat },
        Category: "Lab"
    )]
    public const string Query = "prd-agent-web.arena.query::chat";
}
```

### 3.3 å¤ç”¨ç°æœ‰ RunStream

å‰ç«¯è°ƒç”¨ `POST /api/lab/model/runs/stream` æ—¶ï¼š

```json
{
  "promptText": "ç”¨æˆ·è¾“å…¥çš„é—®é¢˜",
  "models": [
    { "platformId": "xxx", "modelId": "gpt-4o", "modelName": "gpt-4o" },
    { "platformId": "yyy", "modelId": "claude-3-5-sonnet-20241022", "modelName": "claude-3-5-sonnet-20241022" },
    { "platformId": "zzz", "modelId": "deepseek-chat", "modelName": "deepseek-chat" }
  ],
  "params": {
    "maxConcurrency": 20,
    "repeatN": 1
  }
}
```

å®Œå…¨å¤ç”¨ç°æœ‰ SSE äº‹ä»¶åè®®ï¼š`runStart` â†’ `modelStart` â†’ `firstToken` â†’ `delta` â†’ `modelDone` â†’ `runDone`

## 4. å‰ç«¯è®¾è®¡

### 4.1 æ–°å¢æ–‡ä»¶

```
prd-admin/src/pages/lab-arena/
â”œâ”€â”€ ArenaLabTab.tsx              # ä¸»ç»„ä»¶
â””â”€â”€ components/
    â”œâ”€â”€ ArenaInput.tsx           # è¾“å…¥åŒºï¼ˆé—®é¢˜+é¢„è®¾é€‰æ‹©+å‘é€æŒ‰é’®ï¼‰
    â”œâ”€â”€ ArenaGrid.tsx            # å“åº”å¯¹æ¯”ç½‘æ ¼
    â””â”€â”€ ArenaResponseCard.tsx    # å•æ¨¡å‹å“åº”å¡ç‰‡
```

### 4.2 UI å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ AI ç«æŠ€åœº                                    [å†å²è®°å½• â–¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¾“å…¥ä½ çš„é—®é¢˜ï¼Œä¸€é”®è¯¢é—®å…¨çƒé¡¶çº§ AI ...                    â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚                                          [âš¡ é—®æ‰€æœ‰AI] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                            â”‚
â”‚  é¢„è®¾ï¼š[â— å…¨éƒ¨(12)] [â—‹ å…¨çƒå‰æ²¿(5)] [â—‹ å›½äº§å‰æ²¿(4)]          â”‚
â”‚        [â—‹ æ¨ç†ä¸“ç²¾(3)] [â—‹ æ€§ä»·æ¯”(4)]                        â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å“åº”å¯¹æ¯”åŒº - è‡ªé€‚åº”ç½‘æ ¼]                                    â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â—‰ GPT-4o        â”‚  â”‚ â—‰ Claude 3.5    â”‚  â”‚ â—‰ Gemini â”‚  â”‚
â”‚  â”‚ OpenAI          â”‚  â”‚ Anthropic       â”‚  â”‚ Google   â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
â”‚  â”‚ TTFT: 82ms      â”‚  â”‚ TTFT: 65ms âš¡   â”‚  â”‚ Â·Â·Â·åŠ è½½ä¸­ â”‚  â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚          â”‚  â”‚
â”‚  â”‚ è¿™æ˜¯GPT-4oçš„    â”‚  â”‚ è¿™æ˜¯Claudeçš„    â”‚  â”‚          â”‚  â”‚
â”‚  â”‚ å›ç­”å†…å®¹ï¼Œæ­£åœ¨   â”‚  â”‚ å›ç­”å†…å®¹ï¼Œæ­£åœ¨   â”‚  â”‚          â”‚  â”‚
â”‚  â”‚ æµå¼è¾“å‡ºä¸­...   â”‚  â”‚ æµå¼è¾“å‡ºä¸­...   â”‚  â”‚          â”‚  â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚          â”‚  â”‚
â”‚  â”‚ [å¤åˆ¶] [å±•å¼€]   â”‚  â”‚ [å¤åˆ¶] [å±•å¼€]   â”‚  â”‚          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â—‰ DeepSeek V3   â”‚  â”‚ â—‰ Qwen-Max     â”‚  â”‚ âœ• è±†åŒ…    â”‚  â”‚
â”‚  â”‚ DeepSeek        â”‚  â”‚ Alibaba        â”‚  â”‚ é”™è¯¯:... â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
â”‚  â”‚ TTFT: 45ms âš¡âš¡  â”‚  â”‚ TTFT: 120ms    â”‚  â”‚ 429 é™æµ â”‚  â”‚
â”‚  â”‚ ...             â”‚  â”‚ ...             â”‚  â”‚          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç»Ÿè®¡: 6 æ¨¡å‹ | æœ€å¿«é¦–å­—: DeepSeek V3 (45ms) | å¹³å‡: 88ms   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ArenaResponseCard çŠ¶æ€æœº

```
[waiting] â†’ [streaming] â†’ [done]
              â†“
           [error]
```

æ¯å¼ å¡ç‰‡ç‹¬ç«‹å±•ç¤ºï¼š
- **Header**: æ¨¡å‹å + å¹³å°æ ‡ç­¾ + çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆè„‰å†²åŠ¨ç”»/å®Œæˆå‹¾/é”™è¯¯å‰ï¼‰
- **Metrics**: TTFTï¼ˆé¦–å­—å»¶è¿Ÿï¼‰ã€Totalï¼ˆæ€»è€—æ—¶ï¼‰ã€å­—ç¬¦æ•°
- **Body**: å®Œæ•´æµå¼æ–‡æœ¬ï¼ˆæ”¯æŒ Markdown æ¸²æŸ“ï¼‰
- **Footer**: [å¤åˆ¶] [å±•å¼€å…¨å±] æ“ä½œ

### 4.4 äº¤äº’æµç¨‹

```
1. ç”¨æˆ·è¿›å…¥ AI ç«æŠ€åœº Tab
2. è‡ªåŠ¨è°ƒç”¨ GET /arena-presets è·å–é¢„è®¾åˆ†ç»„
3. é»˜è®¤é€‰ä¸­"å…¨éƒ¨"åˆ†ç»„ï¼Œå±•ç¤ºå¯ç”¨æ¨¡å‹åˆ—è¡¨
4. ç”¨æˆ·è¾“å…¥é—®é¢˜
5. ç‚¹å‡»"é—®æ‰€æœ‰ AI"
6. å‰ç«¯æ„å»º RunStreamRequestï¼Œè°ƒç”¨ POST /runs/stream
7. SSE äº‹ä»¶é©±åŠ¨å¡ç‰‡çŠ¶æ€æ›´æ–°ï¼š
   - modelStart â†’ åˆ›å»ºå¡ç‰‡ï¼ˆwaiting â†’ streamingï¼‰
   - firstToken â†’ æ˜¾ç¤º TTFT
   - delta â†’ è¿½åŠ æ–‡æœ¬
   - modelDone â†’ æ˜¾ç¤ºæ€»è€—æ—¶ï¼ˆstreaming â†’ doneï¼‰
   - modelError â†’ æ˜¾ç¤ºé”™è¯¯ï¼ˆâ†’ errorï¼‰
   - runDone â†’ æ›´æ–°ç»Ÿè®¡æ 
8. ç”¨æˆ·å¯ä»¥åœ¨æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­ï¼š
   - åˆ‡æ¢é¢„è®¾åˆ†ç»„ï¼ˆä¸‹æ¬¡æŸ¥è¯¢ç”Ÿæ•ˆï¼‰
   - å¤åˆ¶å·²å®Œæˆçš„å›ç­”
   - å±•å¼€æŸä¸ªå¡ç‰‡æŸ¥çœ‹å®Œæ•´å†…å®¹
```

### 4.5 LabPage.tsx æ”¹åŠ¨

```diff
- type LabTab = 'workshop' | 'llm' | 'desktop' | 'showcase';
+ type LabTab = 'workshop' | 'llm' | 'desktop' | 'showcase' | 'arena';

  <TabBar items={[
    { key: 'workshop', label: 'è¯•éªŒè½¦é—´', icon: <FlaskConical size={14} /> },
    { key: 'llm', label: 'å¤§æ¨¡å‹å®éªŒå®¤', icon: <Sparkles size={14} /> },
    { key: 'desktop', label: 'æ¡Œé¢å®éªŒå®¤', icon: <Monitor size={14} /> },
    { key: 'showcase', label: 'ç‰¹æ•ˆå±•ç¤º', icon: <Wand2 size={14} /> },
+   { key: 'arena', label: 'AI ç«æŠ€åœº', icon: <Swords size={14} /> },
  ]} />

+ {tab === 'arena' && <ArenaLabTab />}
```

## 5. æ•°æ®æµ

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   ç”¨æˆ·è¾“å…¥    â”‚
                  â”‚  "ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—"â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ArenaLabTab.tsx    â”‚
              â”‚  æ„å»º RunStreamRequestâ”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ POST /api/lab/model/runs/stream
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ModelLabController â”‚
              â”‚  RunStream()       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ å¹¶è¡Œè°ƒåº¦ (SemaphoreSlim)
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼             â–¼             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ GPT-4o  â”‚  â”‚ Claude  â”‚  â”‚DeepSeek â”‚  ... N ä¸ªæ¨¡å‹
      â”‚ OpenAI  â”‚  â”‚Anthropicâ”‚  â”‚DeepSeek â”‚
      â”‚ Client  â”‚  â”‚ Client  â”‚  â”‚ Client  â”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
           â”‚             â”‚             â”‚
           â–¼             â–¼             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚     SSE äº‹ä»¶æµ (text/event-stream) â”‚
      â”‚                                  â”‚
      â”‚  event: model                    â”‚
      â”‚  data: {"type":"modelStart",...} â”‚
      â”‚                                  â”‚
      â”‚  event: model                    â”‚
      â”‚  data: {"type":"delta",          â”‚
      â”‚         "content":"é‡å­è®¡ç®—æ˜¯..."}  â”‚
      â”‚                                  â”‚
      â”‚  event: model                    â”‚
      â”‚  data: {"type":"modelDone",...}  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  ArenaGrid.tsx  â”‚
           â”‚  N å¼ å“åº”å¡ç‰‡     â”‚
           â”‚  å®æ—¶æµå¼æ›´æ–°     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6. çŠ¶æ€ç®¡ç†

å‰ç«¯ä½¿ç”¨ç»„ä»¶å†… `useState` / `useRef` ç®¡ç†ï¼Œä¸å¼•å…¥æ–° Storeï¼ˆä¿æŒç®€å•ï¼‰ï¼š

```typescript
interface ArenaState {
  // è¾“å…¥
  prompt: string;
  selectedPresetKey: string;  // 'all' | 'global-frontier' | ...

  // é¢„è®¾æ•°æ®
  presets: ArenaPreset[];
  presetsLoading: boolean;

  // è¿è¡ŒçŠ¶æ€
  isRunning: boolean;
  runId: string | null;

  // å“åº”å¡ç‰‡
  cards: Map<string, ArenaCard>;  // key = itemId
}

interface ArenaCard {
  itemId: string;
  modelId: string;
  displayName: string;
  platformName: string;
  status: 'waiting' | 'streaming' | 'done' | 'error';
  ttftMs: number | null;
  totalMs: number | null;
  text: string;           // ç´¯ç§¯çš„å®Œæ•´æ–‡æœ¬
  errorMessage: string | null;
}
```

## 7. å®ç°æ­¥éª¤

### Phase 1: åç«¯ï¼ˆå¢é‡æ”¹åŠ¨ï¼‰

1. **ModelLabController** æ–°å¢ `GetArenaPresets` ç«¯ç‚¹
   - æ‰«æ `llm_platforms` + `llm_models`
   - æŒ‰è§„åˆ™åˆ†ç»„è¿”å›
   - æ¯ä¸ªæ¨¡å‹è¿”å› `{ platformId, modelId, displayName, tags }`

2. **AppCallerRegistry** æ³¨å†Œ `Arena.Query`
   - `"prd-agent-web.arena.query::chat"`

### Phase 2: å‰ç«¯ï¼ˆæ–°å¢ç»„ä»¶ï¼‰

3. **services å±‚**æ–°å¢ `getArenaPresets` API å‡½æ•°

4. **ArenaLabTab.tsx** ä¸»ç»„ä»¶
   - åŠ è½½é¢„è®¾åˆ†ç»„
   - ç®¡ç†è¾“å…¥/è¿è¡ŒçŠ¶æ€
   - è°ƒç”¨ `runModelLabStream` å¤ç”¨ç°æœ‰æµå¼æ¥å£

5. **ArenaInput.tsx** è¾“å…¥åŒº
   - é—®é¢˜è¾“å…¥æ¡†ï¼ˆæ”¯æŒ Shift+Enter æ¢è¡Œï¼ŒEnter å‘é€ï¼‰
   - é¢„è®¾åˆ†ç»„é€‰æ‹©å™¨ï¼ˆRadio Groupï¼‰
   - "é—®æ‰€æœ‰ AI" æŒ‰é’®

6. **ArenaGrid.tsx** å“åº”ç½‘æ ¼
   - è‡ªé€‚åº”ç½‘æ ¼å¸ƒå±€ï¼ˆ`grid-cols-1 md:grid-cols-2 xl:grid-cols-3`ï¼‰
   - SSE äº‹ä»¶é©±åŠ¨å¡ç‰‡åˆ›å»ºå’Œæ›´æ–°
   - åº•éƒ¨ç»Ÿè®¡æ 

7. **ArenaResponseCard.tsx** å“åº”å¡ç‰‡
   - çŠ¶æ€æŒ‡ç¤ºå™¨ (è„‰å†²/å‹¾/å‰)
   - TTFT + Total æŒ‡æ ‡
   - æµå¼æ–‡æœ¬å±•ç¤ºï¼ˆå¯é€‰ Markdown æ¸²æŸ“ï¼‰
   - å¤åˆ¶/å±•å¼€æ“ä½œ

### Phase 3: é›†æˆ

8. **LabPage.tsx** æ·»åŠ  Tab å…¥å£
9. æµ‹è¯•ç«¯åˆ°ç«¯æµç¨‹

## 8. æƒé™

å¤ç”¨ç°æœ‰ Lab æƒé™ï¼š
- è¯»å–ï¼š`lab.read`
- è¿è¡Œï¼š`lab.write`

æ— éœ€æ–°å¢æƒé™ã€‚

## 9. ä¸åšçš„äº‹æƒ… (Out of Scope)

- **ä¸æ–°å»º Controller** - å¤ç”¨ ModelLabController
- **ä¸æ–°å»ºæ•°æ®åº“é›†åˆ** - å¤ç”¨ model_lab_runs / model_lab_run_items
- **ä¸åšæŠ•ç¥¨/è¯„åˆ†ç³»ç»Ÿ** - v1 ä»…åšå¯¹æ¯”å±•ç¤º
- **ä¸åšå†å²è®°å½•æŒä¹…åŒ–** - è¿è¡Œè®°å½•å·²ç”± ModelLab çš„ Run/RunItem æœºåˆ¶ä¿å­˜
- **ä¸åšè‡ªå®šä¹‰ system prompt** - v1 ä½¿ç”¨ç©º system promptï¼ˆçº¯å‡€å¯¹æ¯”ï¼‰
- **ä¸åšå¤šè½®å¯¹è¯** - v1 åªæ”¯æŒå•è½®é—®ç­”

## 10. åç»­æ¼”è¿›æ–¹å‘ (Future)

| æ–¹å‘ | è¯´æ˜ |
|------|------|
| æŠ•ç¥¨è¯„åˆ† | ç”¨æˆ·å¯¹æ¯ä¸ªå›ç­”ç‚¹èµ/è¸©ï¼Œå½¢æˆæ¨¡å‹ ELO æ’å |
| ç›²è¯„æ¨¡å¼ | éšè—æ¨¡å‹åç§°ï¼Œç”¨æˆ·å…ˆè¯„åˆ†å†æ­æ™“ |
| å¤šè½®è¿½é—® | å¯¹æŸä¸ªæ¨¡å‹çš„å›ç­”ç»§ç»­è¿½é—® |
| è‡ªå®šä¹‰åˆ†ç»„ | ç”¨æˆ·è‡ªå»ºå¸¸ç”¨æ¨¡å‹ç»„åˆ |
| åˆ†äº«åŠŸèƒ½ | ç”Ÿæˆå¯¹æ¯”ç»“æœçš„åˆ†äº«é“¾æ¥ |
| Token æˆæœ¬å¯¹æ¯” | å±•ç¤ºæ¯ä¸ªæ¨¡å‹çš„ token æ¶ˆè€—å’Œä¼°ç®—è´¹ç”¨ |
