# AI ç«æŠ€åœº (AI Arena) - è®¾è®¡æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: v3.0 | **æ—¥æœŸ**: 2026-02-24
>
> **v3.0 å˜æ›´**: ç”¨æˆ·é¡µä¸ç®¡ç†é¡µå®Œå…¨åˆ†ç¦» + ç›²è¯„æ¨¡å¼ï¼ˆå‚è€ƒ arena.aiï¼‰ã€‚
> **v2.0 å˜æ›´**: åºŸå¼ƒè‡ªåŠ¨æ‰«ææ–¹æ¡ˆï¼Œæ”¹ä¸ºç®¡ç†å‘˜æ‰‹åŠ¨é…ç½®æ§½ä½ã€‚

## 1. éœ€æ±‚æ¦‚è¿°

### 1.1 æ ¸å¿ƒä½“éªŒ

ç”¨æˆ·è¿›å…¥ç‹¬ç«‹çš„ AI ç«æŠ€åœºé¡µé¢ï¼Œè¾“å…¥é—®é¢˜åç³»ç»Ÿå°†é—®é¢˜å¹¶è¡Œå‘é€ç»™å¤šä¸ª AI æ¨¡å‹ã€‚**å“åº”ä»¥åŒ¿åå½¢å¼ï¼ˆåŠ©æ‰‹ A / åŠ©æ‰‹ B / ...ï¼‰å±•ç¤º**ï¼Œç”¨æˆ·å…ˆé˜…è¯»å›ç­”å†…å®¹ï¼Œæ‰‹åŠ¨ç‚¹å‡»"æ­æ™“æ¨¡å‹"åæ‰æ˜¾ç¤ºæ¯ä¸ªåŠ©æ‰‹å¯¹åº”çš„çœŸå®æ¨¡å‹åç§°ã€‚

### 1.2 ä¸¤ä¸ªç‹¬ç«‹ç•Œé¢

| ç•Œé¢ | è·¯ç”± | å—ä¼— | å®šä½ |
|------|------|------|------|
| **ç”¨æˆ·å¯¹æˆ˜é¡µ** | `/arena` | æ‰€æœ‰ç”¨æˆ· | ç›²è¯„å¯¹æˆ˜ + èŠå¤©ä½“éªŒ |
| **ç®¡ç†é…ç½®é¡µ** | `/lab?tab=arena` | ç®¡ç†å‘˜ | æ§½ä½/åˆ†ç»„ CRUD ç®¡ç† |

### 1.3 ä¸ arena.ai å¯¹æ ‡

| ç»´åº¦ | arena.ai | æˆ‘ä»¬çš„ç«æŠ€åœº |
|------|----------|------------|
| å¯¹æˆ˜æ¨¡å¼ | 2 ä¸ªæ¨¡å‹å¯¹æˆ˜ | N ä¸ªæ¨¡å‹åŒæ—¶å¯¹æˆ˜ï¼ˆç®¡ç†å‘˜é…ç½®ï¼‰ |
| åŒ¿åå±•ç¤º | åŠ©æ‰‹ A / åŠ©æ‰‹ B | åŠ©æ‰‹ A / B / C / ... |
| æ­æ™“æœºåˆ¶ | æŠ•ç¥¨åæ­æ™“ | ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»æ­æ™“ï¼ˆv1 ä¸åšæŠ•ç¥¨ï¼‰ |
| å†å²è®°å½• | å·¦ä¾§è¾¹æ  | å·¦ä¾§è¾¹æ  |
| å¤šè½®è¿½é—® | æ”¯æŒ | v1 ä»…å•è½® |

## 2. æ§½ä½ (Slot) æœºåˆ¶ï¼ˆä¸å˜ï¼‰

### 2.1 è®¾è®¡ç†å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç«æŠ€åœºä¸å…³å¿ƒ"ç³»ç»Ÿé‡Œé…äº†å“ªäº›æ¨¡å‹"                         â”‚
â”‚  ç«æŠ€åœºåªå…³å¿ƒ"ç®¡ç†å‘˜æ”¾äº†å“ªäº›é€‰æ‰‹åˆ°æ“‚å°ä¸Š"                  â”‚
â”‚                                                      â”‚
â”‚  æ§½ä½ = æ“‚å°ä¸Šçš„ä¸€ä¸ªå‚èµ›å¸­ä½                              â”‚
â”‚  ç®¡ç†å‘˜å¡«å……æ§½ä½ = æŠŠä¸€ä¸ª AI é€‰æ‰‹å®‰æ’åˆ°å¸­ä½ä¸Š               â”‚
â”‚  æ§½ä½åªéœ€è¦ï¼šå¹³å° + æ¨¡å‹å + æ˜¾ç¤ºå                       â”‚
â”‚  ä¸ä¾èµ– llm_models è¡¨ï¼Œä¸æ±¡æŸ“ç°æœ‰æ¨¡å‹ç®¡ç†                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ•°æ®æ¨¡å‹

**æ–°å¢ MongoDB é›†åˆï¼š`arena_slots`**

```typescript
interface ArenaSlot {
  id: string;
  displayName: string;         // "GPT-4o"ï¼ˆæ­æ™“åå±•ç¤ºï¼‰
  platformId: string;          // å…³è”å¹³å° ID
  modelId: string;             // å¹³å°ä¾§æ¨¡å‹æ ‡è¯†
  group: string;               // æ‰€å±åˆ†ç»„ key
  sortOrder: number;
  enabled: boolean;
  avatarColor?: string;        // "#10a37f"
  description?: string;        // "OpenAI æ——èˆ°æ¨¡å‹"
  createdBy: string;
  createdAt: DateTime;
  updatedAt: DateTime;
}
```

**æ–°å¢ MongoDB é›†åˆï¼š`arena_groups`**

```typescript
interface ArenaGroup {
  id: string;
  key: string;                 // "global-frontier"
  name: string;                // "å…¨çƒå‰æ²¿"
  description?: string;
  sortOrder: number;
  icon?: string;
  createdBy: string;
  createdAt: DateTime;
  updatedAt: DateTime;
}
```

**æ–°å¢ MongoDB é›†åˆï¼š`arena_battles`**ï¼ˆå¯¹æˆ˜è®°å½•ï¼‰

```typescript
interface ArenaBattle {
  id: string;
  userId: string;              // å‘èµ·ç”¨æˆ·
  prompt: string;              // ç”¨æˆ·æé—®
  groupKey: string;            // ä½¿ç”¨çš„åˆ†ç»„
  responses: ArenaBattleResponse[];
  revealed: boolean;           // æ˜¯å¦å·²æ­æ™“
  createdAt: DateTime;
}

interface ArenaBattleResponse {
  slotId: string;
  label: string;               // "åŠ©æ‰‹ A" / "åŠ©æ‰‹ B" / ...
  displayName: string;         // æ­æ™“åæ˜¾ç¤º "GPT-4o"
  platformId: string;
  modelId: string;
  content: string;             // å®Œæ•´å›ç­”æ–‡æœ¬
  ttftMs?: number;
  totalMs?: number;
  status: 'done' | 'error';
  errorMessage?: string;
}
```

## 3. æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ä¾§                                                      â”‚
â”‚                                                             â”‚
â”‚  /arena (ç‹¬ç«‹é¡µé¢)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ä¾§è¾¹æ        â”‚              ä¸»åŒºåŸŸ                     â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚ â”‚æ–°å»ºå¯¹æˆ˜   â”‚ â”‚  â”‚ ç”¨æˆ·æé—® (å³å¯¹é½æ°”æ³¡)              â”‚  â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚                                 â”‚  â”‚    â”‚
â”‚  â”‚ â”‚æœç´¢      â”‚ â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚ â”‚ åŠ©æ‰‹ A   â”‚ â”‚ åŠ©æ‰‹ B   â”‚ ...  â”‚  â”‚    â”‚
â”‚  â”‚ â”‚å†å²è®°å½•   â”‚ â”‚  â”‚ â”‚ (åŒ¿å)   â”‚ â”‚ (åŒ¿å)   â”‚      â”‚  â”‚    â”‚
â”‚  â”‚ â”‚Â· ä»Šå¤©     â”‚ â”‚  â”‚ â”‚ æµå¼è¾“å‡º â”‚ â”‚ æµå¼è¾“å‡º â”‚      â”‚  â”‚    â”‚
â”‚  â”‚ â”‚Â· æ˜¨å¤©     â”‚ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚    â”‚
â”‚  â”‚ â”‚Â· æ›´æ—©     â”‚ â”‚  â”‚                                 â”‚  â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚          [æ­æ™“æ¨¡å‹]               â”‚  â”‚    â”‚
â”‚  â”‚             â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚
â”‚  â”‚             â”‚  â”‚ è¾“å…¥æ¡†: è¯·è¾“å…¥é—®é¢˜...      [å‘é€]  â”‚  â”‚    â”‚
â”‚  â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                    â”‚
â”‚                         â”‚ SSE Stream                         â”‚
â”‚                         â–¼                                    â”‚
â”‚              POST /api/lab/model/runs/stream (å¤ç”¨)           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç®¡ç†ä¾§                                                      â”‚
â”‚                                                             â”‚
â”‚  /lab?tab=arena (å®éªŒå®¤çš„ä¸€ä¸ªTab)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ åˆ†ç»„ç®¡ç† + æ§½ä½ CRUD (ä¸ v2.0 è®¾è®¡ç›¸åŒ)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                    â”‚
â”‚                         â–¼                                    â”‚
â”‚              CRUD /api/lab/arena/groups & /slots              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. åç«¯è®¾è®¡

### 4.1 ArenaControllerï¼ˆç®¡ç†ä¾§ CRUDï¼‰

è·¯ç”±å‰ç¼€ï¼š`/api/lab/arena`ï¼Œæƒé™ï¼š`lab.read` / `lab.write`

```csharp
[ApiController]
[Route("api/lab/arena")]
[Authorize]
[AdminController("lab", AdminPermissionCatalog.LabRead, WritePermission = AdminPermissionCatalog.LabWrite)]
public class ArenaController : ControllerBase
{
    // â”€â”€â”€ åˆ†ç»„ CRUD â”€â”€â”€
    [HttpGet("groups")]         // åˆ—å‡ºæ‰€æœ‰åˆ†ç»„ï¼ˆå«ç»„å†…æ§½ä½ï¼‰
    [HttpPost("groups")]        // åˆ›å»ºåˆ†ç»„
    [HttpPut("groups/{id}")]    // æ›´æ–°åˆ†ç»„
    [HttpDelete("groups/{id}")] // åˆ é™¤åˆ†ç»„ï¼ˆçº§è”åˆ é™¤ç»„å†…æ§½ä½ï¼‰

    // â”€â”€â”€ æ§½ä½ CRUD â”€â”€â”€
    [HttpGet("slots")]              // åˆ—å‡ºæ§½ä½ï¼ˆå¯æŒ‰ group è¿‡æ»¤ï¼‰
    [HttpPost("slots")]             // åˆ›å»ºæ§½ä½
    [HttpPut("slots/{id}")]         // æ›´æ–°æ§½ä½
    [HttpDelete("slots/{id}")]      // åˆ é™¤æ§½ä½
    [HttpPut("slots/{id}/toggle")]  // å¿«é€Ÿå¯ç”¨/ç¦ç”¨

    // â”€â”€â”€ ç”¨æˆ·ä¾§èšåˆ â”€â”€â”€
    [HttpGet("lineup")]    // è¿”å›å½“å‰é˜µå®¹ï¼ˆä»… enabled=trueï¼‰
    [HttpGet("battles")]   // æŸ¥è¯¢ç”¨æˆ·å†å²å¯¹æˆ˜è®°å½•
}
```

### 4.2 Lineup æ¥å£ï¼ˆç”¨æˆ·ä¾§ï¼‰

```typescript
// GET /api/lab/arena/lineup
interface ArenaLineup {
  groups: ArenaLineupGroup[];
  totalSlots: number;
}

interface ArenaLineupGroup {
  key: string;               // "global-frontier"
  name: string;              // "å…¨çƒå‰æ²¿"
  slots: ArenaLineupSlot[];
}

interface ArenaLineupSlot {
  id: string;                // æ§½ä½ ID
  platformId: string;        // å‘èµ·è°ƒç”¨éœ€è¦
  modelId: string;           // å‘èµ·è°ƒç”¨éœ€è¦
  // æ³¨æ„ï¼šä¸è¿”å› displayNameï¼ç›²è¯„æ¨¡å¼ä¸‹å‰ç«¯ä¸çŸ¥é“æ¨¡å‹èº«ä»½
}
```

**å…³é”®**ï¼šlineup æ¥å£**ä¸è¿”å› displayName**ã€‚å‰ç«¯åªæ‹¿åˆ° `platformId + modelId`ï¼Œç”¨äºå‘èµ· SSE æµã€‚åœ¨å‰ç«¯ä¾§ï¼Œæ¯ä¸ª slot è¢«éšæœºåˆ†é…ä¸º "åŠ©æ‰‹ A / B / C ..."ã€‚

### 4.3 æ­æ™“æ¥å£

```typescript
// POST /api/lab/arena/reveal
// Body: { battleId: string } æˆ– { slotIds: string[] }
// è¿”å›æ¯ä¸ª slotId â†’ displayName çš„æ˜ å°„
interface ArenaRevealResponse {
  reveals: Array<{
    slotId: string;
    displayName: string;     // "GPT-4o"
    platformName: string;    // "OpenAI"
    avatarColor?: string;    // "#10a37f"
    description?: string;    // "OpenAI æ——èˆ°æ¨¡å‹"
  }>;
}
```

ç”¨æˆ·ç‚¹å‡»"æ­æ™“æ¨¡å‹"åï¼Œå‰ç«¯è°ƒæ­¤æ¥å£æ‹¿åˆ°çœŸå®èº«ä»½ï¼Œå†æ›´æ–°å¡ç‰‡ headerã€‚

### 4.4 å¯¹æˆ˜è®°å½•ä¿å­˜

```typescript
// POST /api/lab/arena/battles
// åœ¨ runDone åè‡ªåŠ¨ä¿å­˜å¯¹æˆ˜è®°å½•
interface SaveBattleRequest {
  prompt: string;
  groupKey: string;
  responses: Array<{
    slotId: string;
    label: string;        // "åŠ©æ‰‹ A"
    content: string;
    ttftMs?: number;
    totalMs?: number;
    status: 'done' | 'error';
    errorMessage?: string;
  }>;
}

// GET /api/lab/arena/battles?page=1&pageSize=20
// è¿”å›ç”¨æˆ·çš„å†å²å¯¹æˆ˜åˆ—è¡¨ï¼ˆç”¨äºä¾§è¾¹æ ï¼‰
```

### 4.5 AppCallerCode

```csharp
public static class Arena
{
    [AppCallerMetadata(
        displayName: "AIç«æŠ€åœº-å¯¹æˆ˜",
        description: "AIç«æŠ€åœºç›²è¯„å¯¹æˆ˜",
        ModelTypes: new[] { ModelTypes.Chat },
        Category: "Arena"
    )]
    public const string Query = "prd-agent-web.arena.query::chat";
}
```

### 4.6 å¤ç”¨ ModelLab RunStream

å¯¹æˆ˜å‘èµ·æ—¶ï¼Œå‰ç«¯è°ƒç”¨ç°æœ‰ `POST /api/lab/model/runs/stream`ï¼š

```json
{
  "promptText": "ç”¨æˆ·çš„é—®é¢˜",
  "models": [
    { "platformId": "plt_openai", "modelId": "gpt-4o", "modelName": "gpt-4o" },
    { "platformId": "plt_anthropic", "modelId": "claude-3-5-sonnet", "modelName": "claude-3-5-sonnet" }
  ],
  "params": { "maxConcurrency": 20, "repeatN": 1 }
}
```

å‰ç«¯æ”¶åˆ° SSE äº‹ä»¶åï¼Œ**ä¸ä½¿ç”¨äº‹ä»¶ä¸­çš„æ¨¡å‹å**ï¼Œè€Œæ˜¯æŒ‰ slotId â†’ label æ˜ å°„å±•ç¤ºä¸º "åŠ©æ‰‹ A / B / C"ã€‚

## 5. ç”¨æˆ·é¡µå‰ç«¯è®¾è®¡

### 5.1 æ–°å¢æ–‡ä»¶

```
prd-admin/src/pages/arena/
â”œâ”€â”€ ArenaPage.tsx                  # ç”¨æˆ·å¯¹æˆ˜é¡µï¼ˆç‹¬ç«‹è·¯ç”± /arenaï¼‰
â””â”€â”€ components/
    â”œâ”€â”€ ArenaSidebar.tsx            # å·¦ä¾§è¾¹æ ï¼šæ–°å»ºå¯¹æˆ˜ + å†å²è®°å½•
    â”œâ”€â”€ ArenaBattlePanel.tsx        # ä¸»å¯¹æˆ˜åŒºåŸŸ
    â”œâ”€â”€ ArenaResponsePanel.tsx      # å•ä¸ªåŒ¿ååŠ©æ‰‹çš„å“åº”é¢æ¿
    â”œâ”€â”€ ArenaRevealOverlay.tsx      # æ­æ™“åŠ¨æ•ˆ overlay
    â””â”€â”€ ArenaComposer.tsx           # åº•éƒ¨è¾“å…¥æ¡†
```

### 5.2 ç”¨æˆ·é¡µå¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [â‰¡]  AI ç«æŠ€åœº                              åˆ†ç»„: [å…¨çƒå‰æ²¿ â–¾]  [âš™]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            â”‚                                                        â”‚
â”‚  æ–°å»ºå¯¹æˆ˜   â”‚                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  æœç´¢...    â”‚    â”‚                                            â”‚     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚  ç”¨æˆ·                                      â”‚     â”‚
â”‚            â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  ä»Šå¤©       â”‚    â”‚  â”‚ è¯·è§£é‡Šä¸€ä¸‹é‡å­è®¡ç®—çš„åŸºæœ¬åŸç†            â”‚  â”‚     â”‚
â”‚  Â· é‡å­è®¡ç®—  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  Â· é»‘æ´é—®é¢˜  â”‚    â”‚                                            â”‚     â”‚
â”‚            â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚  æ˜¨å¤©       â”‚    â”‚  â”‚ åŠ©æ‰‹ A             â”‚ â”‚ åŠ©æ‰‹ B           â”‚ â”‚     â”‚
â”‚  Â· ä»£ç ä¼˜åŒ–  â”‚    â”‚  â”‚                   â”‚ â”‚                 â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚ é‡å­è®¡ç®—æ˜¯ä¸€ç§åˆ©ç”¨  â”‚ â”‚ é‡å­è®¡ç®—æ˜¯åŸºäº   â”‚ â”‚     â”‚
â”‚  æ›´æ—©       â”‚    â”‚  â”‚ é‡å­åŠ›å­¦åŸç†è¿›è¡Œ   â”‚ â”‚ é‡å­åŠ›å­¦ä¸­é‡å­   â”‚ â”‚     â”‚
â”‚  Â· ...     â”‚    â”‚  â”‚ ä¿¡æ¯å¤„ç†çš„è®¡ç®—æ–¹å¼  â”‚ â”‚ æ¯”ç‰¹çš„å åŠ å’Œçº    â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚ ...               â”‚ â”‚ ç¼ æ•ˆåº”çš„æ–°å‹è®¡   â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚                   â”‚ â”‚ ç®—èŒƒå¼...        â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚            [å±•å¼€]  â”‚ â”‚          [å±•å¼€]  â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚            â”‚    â”‚                                            â”‚     â”‚
â”‚            â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚            â”‚    â”‚  â”‚ åŠ©æ‰‹ C             â”‚ â”‚ åŠ©æ‰‹ D           â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚                   â”‚ â”‚                 â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚ é‡å­è®¡ç®—ä¸ä¼ ç»Ÿè®¡ç®—  â”‚ â”‚ Â·Â·Â·æ­£åœ¨æ€è€ƒä¸­     â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚ æœ€å¤§çš„ä¸åŒåœ¨äº...  â”‚ â”‚                 â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â”‚            [å±•å¼€]  â”‚ â”‚                 â”‚ â”‚     â”‚
â”‚            â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚            â”‚    â”‚                                            â”‚     â”‚
â”‚            â”‚    â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚     â”‚
â”‚            â”‚    â”‚           â”‚  ğŸ‘ æ­æ™“æ¨¡å‹èº«ä»½   â”‚             â”‚     â”‚
â”‚            â”‚    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚     â”‚
â”‚            â”‚    â”‚                                            â”‚     â”‚
â”‚            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚            â”‚                                                        â”‚
â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” [å‘é€]  â”‚
â”‚            â”‚  â”‚ è¾“å…¥ä½ çš„é—®é¢˜...                            â”‚         â”‚
â”‚            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ­æ™“å‰ vs æ­æ™“å

**æ­æ™“å‰**ï¼ˆç›²è¯„çŠ¶æ€ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠ©æ‰‹ A        [å±•å¼€] â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                    â”‚
â”‚ é‡å­è®¡ç®—æ˜¯ä¸€ç§åˆ©ç”¨  â”‚
â”‚ é‡å­åŠ›å­¦åŸç†è¿›è¡Œ   â”‚
â”‚ ä¿¡æ¯å¤„ç†çš„è®¡ç®—æ–¹å¼  â”‚
â”‚ ...               â”‚
â”‚                    â”‚
â”‚ [å¤åˆ¶]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- Header ä»…æ˜¾ç¤º **"åŠ©æ‰‹ A"**ï¼Œæ— ä»»ä½•æ¨¡å‹èº«ä»½æç¤º
- æ— å¹³å°æ ‡ç­¾ã€æ— é¢œè‰²ã€æ— å›¾æ ‡
- æ‰€æœ‰å¡ç‰‡å¤–è§‚å®Œå…¨ä¸€è‡´ï¼Œé¿å…æš—ç¤º

**æ­æ™“å**ï¼ˆç‚¹å‡»"æ­æ™“æ¨¡å‹èº«ä»½"ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–  åŠ©æ‰‹ A â†’ GPT-4o  â”‚
â”‚   OpenAI     [å±•å¼€] â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                    â”‚
â”‚ é‡å­è®¡ç®—æ˜¯ä¸€ç§åˆ©ç”¨  â”‚
â”‚ é‡å­åŠ›å­¦åŸç†è¿›è¡Œ   â”‚
â”‚ ä¿¡æ¯å¤„ç†çš„è®¡ç®—æ–¹å¼  â”‚
â”‚ ...               â”‚
â”‚                    â”‚
â”‚ TTFT: 82ms | 1.2s â”‚
â”‚ [å¤åˆ¶]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- Header å˜ä¸º **"åŠ©æ‰‹ A â†’ GPT-4o"**ï¼Œå¸¦å¹³å°æ ‡ç­¾å’Œä¸»é¢˜è‰²
- æ€§èƒ½æŒ‡æ ‡ï¼ˆTTFTã€æ€»è€—æ—¶ï¼‰æ­æ™“åæ‰æ˜¾ç¤º
- æ­æ™“åŠ¨ç”»ï¼šå¡ç‰‡è½»å¾®éœ‡åŠ¨ + æ ‡ç­¾ç¿»è½¬æ•ˆæœ

### 5.4 äº¤äº’æµç¨‹

```
ç”¨æˆ·å¯¹æˆ˜æµç¨‹ï¼š

1. è¿›å…¥ /arena é¡µé¢
2. è‡ªåŠ¨åŠ è½½ lineupï¼ˆæ‹¿åˆ°æ§½ä½åˆ—è¡¨ï¼Œä½†ä¸å«æ¨¡å‹åï¼‰
3. ç”¨æˆ·é€‰æ‹©åˆ†ç»„ï¼ˆé»˜è®¤"å…¨éƒ¨"ï¼‰
4. ç”¨æˆ·è¾“å…¥é—®é¢˜ï¼Œç‚¹å‡»"å‘é€"æˆ–æŒ‰ Enter
5. å‰ç«¯ä¸ºæ¯ä¸ªæ§½ä½åˆ†é…åŒ¿åæ ‡ç­¾ï¼šåŠ©æ‰‹ A / B / C / D ...
   - åˆ†é…é¡ºåºéšæœºæ‰“ä¹±ï¼ˆé¿å…"ç¬¬ä¸€ä¸ªæ°¸è¿œæ˜¯ GPT"çš„æš—ç¤ºï¼‰
6. è°ƒç”¨ POST /api/lab/model/runs/stream å‘èµ·å¹¶è¡Œè¯·æ±‚
7. SSE äº‹ä»¶é©±åŠ¨å¡ç‰‡æ›´æ–°ï¼š
   - modelStart â†’ å¡ç‰‡å‡ºç°ï¼ˆæ˜¾ç¤º"åŠ©æ‰‹ X - æ­£åœ¨æ€è€ƒ..."ï¼‰
   - delta â†’ æµå¼è¿½åŠ æ–‡æœ¬
   - modelDone â†’ æ ‡è®°å®Œæˆï¼ˆä½†ä»ç„¶åŒ¿åï¼‰
   - modelError â†’ æ˜¾ç¤º"åŠ©æ‰‹ X - å›ç­”å¤±è´¥"
   - runDone â†’ æ‰€æœ‰æ¨¡å‹å®Œæˆ
8. æ‰€æœ‰æ¨¡å‹å®Œæˆåï¼Œ"æ­æ™“æ¨¡å‹èº«ä»½"æŒ‰é’®é«˜äº®å¯ç‚¹å‡»
9. ç”¨æˆ·ç‚¹å‡»æ­æ™“ â†’ è°ƒç”¨ POST /api/lab/arena/reveal
10. å¡ç‰‡ header æ’­æ”¾æ­æ™“åŠ¨ç”»ï¼Œæ˜¾ç¤ºçœŸå®æ¨¡å‹å + æ€§èƒ½æŒ‡æ ‡
11. å¯¹æˆ˜è®°å½•è‡ªåŠ¨ä¿å­˜åˆ° arena_battles
```

### 5.5 ä¾§è¾¹æ å†å²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°å»ºå¯¹æˆ˜    â”‚  â† æ¸…ç©ºå½“å‰å¯¹è¯ï¼Œå¼€å§‹æ–°ä¸€è½®
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ” æœç´¢...  â”‚  â† æŒ‰æé—®å†…å®¹æœç´¢
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ä»Šå¤©        â”‚
â”‚  Â· é‡å­è®¡ç®—   â”‚  â† æ˜¾ç¤º prompt æ‘˜è¦ï¼ˆå‰20å­—ï¼‰
â”‚  Â· é»‘æ´é—®é¢˜   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  æ˜¨å¤©        â”‚
â”‚  Â· ä»£ç ä¼˜åŒ–   â”‚
â”‚  Â· Reactæ€§èƒ½  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  æ›´æ—©        â”‚
â”‚  Â· ...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ç‚¹å‡»å†å²è®°å½• â†’ åŠ è½½å¯¹åº”çš„ battle æ•°æ® â†’ æ¸²æŸ“å›ç­”ï¼ˆå·²æ­æ™“çš„ä¿æŒæ­æ™“çŠ¶æ€ï¼‰

### 5.6 è·¯ç”±æ³¨å†Œ

```typescript
// App.tsx
<Route path="/arena" element={
  <RequirePermission perm="access">
    <ArenaPage />
  </RequirePermission>
} />
```

**ä¸åœ¨ LabPage å†…**ï¼Œè€Œæ˜¯ç‹¬ç«‹çš„ä¸€çº§è·¯ç”±ã€‚å¯¼èˆªèœå•ä¸­ä½œä¸ºç‹¬ç«‹å…¥å£ã€‚

### 5.7 çŠ¶æ€ç®¡ç†

```typescript
interface ArenaPageState {
  // é˜µå®¹
  lineup: ArenaLineup | null;
  selectedGroupKey: string | 'all';

  // å½“å‰å¯¹æˆ˜
  currentBattleId: string | null;
  prompt: string;
  isRunning: boolean;
  revealed: boolean;              // æ˜¯å¦å·²æ­æ™“

  // åŒ¿åæ˜ å°„ï¼ˆå‰ç«¯ç”Ÿæˆï¼Œéšæœºæ‰“ä¹±ï¼‰
  slotLabelMap: Map<string, string>;  // slotId â†’ "åŠ©æ‰‹ A"

  // å“åº”é¢æ¿
  panels: Map<string, ArenaPanel>;

  // æ­æ™“æ•°æ®
  revealData: Map<string, RevealInfo> | null;

  // å†å²
  battles: ArenaBattle[];
  battlesLoading: boolean;
}

interface ArenaPanel {
  slotId: string;
  label: string;               // "åŠ©æ‰‹ A"ï¼ˆåŒ¿åæ ‡ç­¾ï¼‰
  status: 'waiting' | 'streaming' | 'done' | 'error';
  text: string;
  ttftMs: number | null;
  totalMs: number | null;
  errorMessage: string | null;
}

interface RevealInfo {
  displayName: string;         // "GPT-4o"
  platformName: string;        // "OpenAI"
  avatarColor?: string;
  description?: string;
}
```

## 6. ç®¡ç†é¡µå‰ç«¯è®¾è®¡

### 6.1 ä½ç½®

åœ¨ LabPage.tsx æ–°å¢ "AI ç«æŠ€åœº" Tabï¼ˆç®¡ç†å‘˜çœ‹åˆ°çš„é…ç½®å…¥å£ï¼‰ï¼š

```diff
+ { key: 'arena', label: 'AI ç«æŠ€åœº', icon: <Swords size={14} /> },
```

### 6.2 ç®¡ç†é¡µç»„ä»¶

```
prd-admin/src/pages/lab-arena/
â”œâ”€â”€ ArenaConfigTab.tsx             # Lab Tab å†…çš„ç®¡ç†é¡µ
â””â”€â”€ components/
    â”œâ”€â”€ ArenaGroupList.tsx          # åˆ†ç»„åˆ—è¡¨ï¼ˆå¯æŠ˜å ï¼‰
    â”œâ”€â”€ ArenaSlotCard.tsx           # æ§½ä½å¡ç‰‡ï¼ˆç¼–è¾‘/åˆ é™¤/å¯ç”¨ç¦ç”¨ï¼‰
    â”œâ”€â”€ ArenaGroupDialog.tsx        # æ–°å»º/ç¼–è¾‘åˆ†ç»„å¼¹çª—
    â””â”€â”€ ArenaSlotDialog.tsx         # æ–°å»º/ç¼–è¾‘æ§½ä½å¼¹çª—
```

### 6.3 ç®¡ç†é¡µå¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è¯•éªŒè½¦é—´] [å¤§æ¨¡å‹å®éªŒå®¤] [æ¡Œé¢å®éªŒå®¤] [ç‰¹æ•ˆå±•ç¤º] [AI ç«æŠ€åœº]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ç«æŠ€åœºé€‰æ‰‹ç®¡ç†                                    [+ æ–°å»ºåˆ†ç»„]  â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â–¼ å…¨çƒå‰æ²¿ (4 ä¸ªé€‰æ‰‹)                         [ç¼–è¾‘] [åˆ é™¤] â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ â–  GPT-4o â”‚ â”‚ â–  Claude â”‚ â”‚ â–  Gemini â”‚ â”‚ â–  Grok   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ OpenAI   â”‚ â”‚ Anthro.  â”‚ â”‚ Google   â”‚ â”‚ xAI      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ gpt-4o   â”‚ â”‚ claude.. â”‚ â”‚ gemini.. â”‚ â”‚ grok-2   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ âœ“ å¯ç”¨   â”‚ â”‚ âœ“ å¯ç”¨   â”‚ â”‚ âœ“ å¯ç”¨   â”‚ â”‚ âœ“ å¯ç”¨   â”‚  â”‚ â”‚
â”‚  â”‚  â”‚[ç¼–è¾‘][åˆ ] â”‚ â”‚[ç¼–è¾‘][åˆ ] â”‚ â”‚[ç¼–è¾‘][åˆ ] â”‚ â”‚[ç¼–è¾‘][åˆ ] â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                               [+ æ·»åŠ ]  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚ â–¼ å›½äº§å‰æ²¿ (3 ä¸ªé€‰æ‰‹)                         [ç¼–è¾‘] [åˆ é™¤] â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚DeepSeek  â”‚ â”‚ Qwen-Max â”‚ â”‚ è±†åŒ…      â”‚               â”‚ â”‚
â”‚  â”‚  â”‚ âœ“ å¯ç”¨   â”‚ â”‚ âœ“ å¯ç”¨   â”‚ â”‚ âœ— ç¦ç”¨   â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â”‚                                               [+ æ·»åŠ ]  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚ â–¶ æ¨ç†ä¸“ç²¾ (3 ä¸ªé€‰æ‰‹)                         [ç¼–è¾‘] [åˆ é™¤] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â”‚  æç¤ºï¼šç”¨æˆ·åœ¨ /arena é¡µé¢å¯¹æˆ˜æ—¶ï¼Œæ¨¡å‹åç§°ä»¥åŒ¿åæ–¹å¼å±•ç¤º            â”‚
â”‚  ï¼ˆåŠ©æ‰‹ A / B / C ...ï¼‰ï¼Œç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»åæ‰æ­æ™“çœŸå®èº«ä»½ã€‚             â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 æ·»åŠ æ§½ä½å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ·»åŠ é€‰æ‰‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚ æ˜¾ç¤ºåç§° *                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ GPT-4o                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚ å¹³å° *                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â–¾ é€‰æ‹©å¹³å°                    â”‚ â”‚  â† ä» llm_platforms ä¸‹æ‹‰
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚ æ¨¡å‹æ ‡è¯† *                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ gpt-4o                       â”‚ â”‚  â† æ‰‹åŠ¨è¾“å…¥ï¼Œè‡ªç”±å¡«å†™
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ æç¤ºï¼šå¡«å†™å¹³å°ä¾§çš„æ¨¡å‹ ID          â”‚
â”‚                                  â”‚
â”‚ å¡ç‰‡é¢œè‰²                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [#10a37f] â–                   â”‚ â”‚  â† æ­æ™“åæ˜¾ç¤ºçš„ä¸»é¢˜è‰²
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚ æè¿°                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ OpenAI æ——èˆ°å¤šæ¨¡æ€æ¨¡å‹          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                  â”‚
â”‚           [å–æ¶ˆ]      [ç¡®è®¤æ·»åŠ ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. ç›²è¯„æ ¸å¿ƒæœºåˆ¶

### 7.1 åŒ¿åæ ‡ç­¾åˆ†é…

```typescript
// å‰ç«¯åœ¨å‘èµ·å¯¹æˆ˜æ—¶éšæœºåˆ†é…æ ‡ç­¾
const LABELS = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L'];

function assignLabels(slots: ArenaLineupSlot[]): Map<string, string> {
  // 1. å¤åˆ¶ slots æ•°ç»„
  const shuffled = [...slots];
  // 2. Fisher-Yates éšæœºæ‰“ä¹±
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  // 3. æŒ‰æ‰“ä¹±åé¡ºåºåˆ†é… A/B/C...
  const map = new Map<string, string>();
  shuffled.forEach((slot, idx) => {
    map.set(slot.id, `åŠ©æ‰‹ ${LABELS[idx]}`);
  });
  return map;
}
```

**ä¸ºä»€ä¹ˆå‰ç«¯æ‰“ä¹±**ï¼šé¿å…ç”¨æˆ·é€šè¿‡å“åº”é¡ºåºçŒœæµ‹æ¨¡å‹èº«ä»½ã€‚æ¯æ¬¡å¯¹æˆ˜åˆ†é…éƒ½ä¸åŒã€‚

### 7.2 ä¿¡æ¯éš”ç¦»ç­–ç•¥

| é˜¶æ®µ | å‰ç«¯çŸ¥é“ä»€ä¹ˆ | å‰ç«¯å±•ç¤ºä»€ä¹ˆ |
|------|------------|------------|
| åŠ è½½é˜µå®¹ | slotId, platformId, modelId | æ— ï¼ˆä¸å±•ç¤ºé˜µå®¹è¯¦æƒ…ï¼‰ |
| å‘èµ·å¯¹æˆ˜ | åŒä¸Š | ä»…"æ­£åœ¨å‘é€åˆ° N ä¸ª AI..." |
| æµå¼å“åº” | SSE äº‹ä»¶ä¸­çš„ itemId | **"åŠ©æ‰‹ A / B / C ..."** |
| æ­æ™“å‰ | å†…å­˜ä¸­æœ‰ modelIdï¼ˆå‘è¯·æ±‚å¿…éœ€ï¼‰ | **ä¸¥æ ¼ä¸å±•ç¤º** |
| æ­æ™“å | displayName, platformName, color | å®Œæ•´èº«ä»½ + æ€§èƒ½æŒ‡æ ‡ |

**æ³¨æ„**ï¼šå‰ç«¯å‘è¯·æ±‚æ—¶å¿…é¡»çŸ¥é“ `platformId + modelId`ï¼ˆå¦åˆ™æ— æ³•è°ƒç”¨ SSE æ¥å£ï¼‰ï¼Œä½† UI å±‚ä¸¥æ ¼ä¸æš´éœ²è¿™äº›ä¿¡æ¯ã€‚ç›²è¯„çš„"ç›²"æ˜¯ UI å±‚é¢çš„åŒ¿ååŒ–ï¼Œä¸æ˜¯åŠ å¯†ã€‚

### 7.3 æ­æ™“åŠ¨æ•ˆ

```
æ­æ™“å‰:                        æ­æ™“å:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ©æ‰‹ A       â”‚  â”€â”€ç¿»è½¬â”€â”€â–¶  â”‚ â–  GPT-4o     â”‚
â”‚              â”‚              â”‚   OpenAI     â”‚
â”‚  (æ— é¢œè‰²)     â”‚              â”‚  (ç»¿è‰²ä¸»é¢˜)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŠ¨ç”»åºåˆ—ï¼š
1. æ‰€æœ‰å¡ç‰‡åŒæ—¶è½»å¾®ç¼©å° (scale 0.98)
2. å¡ç‰‡ header åŒºåŸŸç¿»è½¬åŠ¨ç”» (rotateX)
3. ç¿»è½¬åæ˜¾ç¤ºçœŸå®æ¨¡å‹å + å¹³å° + ä¸»é¢˜è‰²
4. å¡ç‰‡æ¢å¤åŸå¤§å° + å¼¹æ€§åŠ¨ç”»
5. æ€§èƒ½æŒ‡æ ‡ (TTFT/è€—æ—¶) ä»åº•éƒ¨æ»‘å…¥
```

## 8. æ•°æ®æµ

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   ç”¨æˆ·è¾“å…¥    â”‚
                  â”‚ "ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—" â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ArenaPage.tsx     â”‚
              â”‚ 1. éšæœºæ‰“ä¹± slots    â”‚
              â”‚ 2. åˆ†é… åŠ©æ‰‹A/B/C   â”‚
              â”‚ 3. æ„å»º models[]    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ POST /api/lab/model/runs/stream
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  ModelLabController â”‚
              â”‚  RunStream()       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ å¹¶è¡Œè°ƒåº¦
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼             â–¼             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Slot 1 â”‚  â”‚  Slot 2 â”‚  â”‚  Slot 3 â”‚
      â”‚ (gpt-4o)â”‚  â”‚(claude) â”‚  â”‚(deepseek)â”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
           â”‚             â”‚             â”‚
           â–¼             â–¼             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        SSE äº‹ä»¶æµ                      â”‚
      â”‚                                      â”‚
      â”‚  å‰ç«¯æ”¶åˆ° delta äº‹ä»¶æ—¶ï¼š                 â”‚
      â”‚  - ä¸çœ‹ modelName                      â”‚
      â”‚  - åªæŒ‰ itemId â†’ slotId â†’ label æ˜ å°„   â”‚
      â”‚  - å±•ç¤ºä¸º "åŠ©æ‰‹ A: é‡å­è®¡ç®—æ˜¯..."        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ArenaBattlePanel    â”‚
              â”‚                    â”‚
              â”‚ [åŠ©æ‰‹A] [åŠ©æ‰‹B]     â”‚  â† åŒ¿åå±•ç¤º
              â”‚ [åŠ©æ‰‹C] [åŠ©æ‰‹D]     â”‚
              â”‚                    â”‚
              â”‚  [ğŸ‘ æ­æ™“æ¨¡å‹èº«ä»½]   â”‚  â† ç”¨æˆ·æ‰‹åŠ¨è§¦å‘
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ POST /api/lab/arena/reveal
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ æ­æ™“åŠ¨ç”»            â”‚
              â”‚ åŠ©æ‰‹A â†’ GPT-4o     â”‚
              â”‚ åŠ©æ‰‹B â†’ Claude     â”‚
              â”‚ åŠ©æ‰‹C â†’ DeepSeek   â”‚
              â”‚ åŠ©æ‰‹D â†’ Qwen       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 9. å®ç°æ­¥éª¤

### Phase 1: åç«¯

1. MongoDbContext æ³¨å†Œ `arena_slots`ã€`arena_groups`ã€`arena_battles`
2. ArenaController å®ç° CRUD + lineup + reveal + battles ç«¯ç‚¹
3. AppCallerRegistry æ³¨å†Œ `Arena.Query`

### Phase 2: å‰ç«¯ - ç®¡ç†é¡µ

4. services å±‚æ–°å¢ Arena ç®¡ç† API
5. ArenaConfigTab.tsx + åˆ†ç»„/æ§½ä½ CRUD ç»„ä»¶
6. LabPage.tsx æ–°å¢ Tab å…¥å£

### Phase 3: å‰ç«¯ - ç”¨æˆ·é¡µ

7. services å±‚æ–°å¢ lineup / reveal / battles API
8. ArenaPage.tsx ä¸»é¡µé¢ï¼ˆè·¯ç”±ã€å¸ƒå±€ï¼‰
9. ArenaSidebar.tsx ä¾§è¾¹æ ï¼ˆå†å²è®°å½•ï¼‰
10. ArenaBattlePanel.tsx å¯¹æˆ˜åŒºåŸŸï¼ˆåŒ¿åå¡ç‰‡ + æ­æ™“ï¼‰
11. ArenaComposer.tsx åº•éƒ¨è¾“å…¥æ¡†
12. App.tsx æ³¨å†Œ `/arena` è·¯ç”± + å¯¼èˆªèœå•å…¥å£

## 10. æƒé™

| æ“ä½œ | æƒé™ |
|------|------|
| è®¿é—®ç”¨æˆ·å¯¹æˆ˜é¡µ `/arena` | `access`ï¼ˆåŸºç¡€æƒé™ï¼‰ |
| ç®¡ç†é¡µé…ç½®æ§½ä½/åˆ†ç»„ | `lab.write` |
| æŸ¥çœ‹ç®¡ç†é¡µ | `lab.read` |

## 11. æ•°æ®åº“å˜æ›´

| é›†åˆå | ç”¨é€” |
|--------|------|
| `arena_groups` | åˆ†ç»„é…ç½® |
| `arena_slots` | é€‰æ‰‹æ§½ä½ |
| `arena_battles` | å¯¹æˆ˜è®°å½• |

## 12. ä¸åšçš„äº‹æƒ… (Out of Scope v1)

- **ä¸åšæŠ•ç¥¨/è¯„åˆ†** â€” v1 ä»…åšåŒ¿åå±•ç¤º + æ‰‹åŠ¨æ­æ™“
- **ä¸åš ELO æ’è¡Œ** â€” æ²¡æœ‰æŠ•ç¥¨å°±æ²¡æœ‰æ’è¡Œ
- **ä¸åšå¤šè½®å¯¹è¯** â€” v1 ä»…å•è½®
- **ä¸åšè‡ªå®šä¹‰ system prompt** â€” çº¯å‡€å¯¹æ¯”
- **ä¸åšåŠ å¯†éš”ç¦»** â€” ç›²è¯„æ˜¯ UI å±‚åŒ¿ååŒ–ï¼Œå‰ç«¯å†…å­˜ä¸­æœ‰ modelIdï¼ˆå‘è¯·æ±‚å¿…éœ€ï¼‰

## 13. åç»­æ¼”è¿›æ–¹å‘ (Future)

| æ–¹å‘ | è¯´æ˜ |
|------|------|
| æŠ•ç¥¨ â†’ æ­æ™“ | ç”¨æˆ·æŠ•ç¥¨"å“ªä¸ªå›ç­”æ›´å¥½" â†’ æŠ•ç¥¨åè‡ªåŠ¨æ­æ™“ |
| ELO æ’è¡Œæ¦œ | åŸºäºæŠ•ç¥¨æ•°æ®è®¡ç®—æ¨¡å‹ ELO åˆ†æ•° |
| ç›²è¯„ 2 é€‰ 1 | æ¯æ¬¡åªæŠ½ 2 ä¸ªæ¨¡å‹å¯¹æˆ˜ï¼ˆç»å…¸ LMSYS æ¨¡å¼ï¼‰ |
| å¤šè½®è¿½é—® | é€‰å®šä¸€ä¸ªåŠ©æ‰‹ç»§ç»­è¿½é—® |
| åˆ†äº«å¯¹æˆ˜ | ç”Ÿæˆå¯¹æˆ˜ç»“æœåˆ†äº«é“¾æ¥ |
| Token æˆæœ¬ | æ­æ™“åæ˜¾ç¤ºæ¯ä¸ªæ¨¡å‹çš„ token æ¶ˆè€— |
| æ‹–æ‹½æ’åº | ç®¡ç†é¡µæ§½ä½æ”¯æŒæ‹–æ‹½è°ƒæ•´ |
