# 周报 2026-W06 (02-03 ~ 02-08)

> **总计 241 次提交 | 352 个文件变更 | +57,589 行 / -4,238 行**

---

## 一、本周完成

### 1. 模型中继 (Model Exchange)

- 新增非标准 API 的中继支持，允许接入不遵循 OpenAI 格式的模型平台
- 实现 Exchange 测试面板，含 3 阶段流水线可视化（请求 → 转换 → 响应）
- 支持智能 URL 路由（文生图 / 图生图自动分发）
- 可配置图片传输模式（auto / base64 / url）
- Exchange 虚拟平台自动注入模型池选择器

### 2. Google Gemini 适配器

- 新增 Google Gemini 原生 `generateContent` API 适配器
- 支持多模态请求格式（text + image parts）

### 3. AI 百宝箱 (AI Toolbox)

- 完成 Phase 0 ~ 1.5：统一入口 → 意图路由 → Agent 执行编排 → 前端页面
- 重新设计为工具集合 / Agent 市场形态
- 支持聊天界面（含文件上传）、工具编辑器（双栏布局 + Tabs）
- 区分定制型 vs 基础型 Agent

### 4. 邮件渠道适配器 (Email Channel)

- 设计并实现多渠道适配器架构
- 完成 IMAP/SMTP 邮件渠道配置
- 邮件意图识别与智能处理 (MVP)
- 可自定义邮件工作流地址 + 工作流管理前端

### 5. 数据迁移代理 (Data Migration Agent)

- 新增数据迁移 Agent，支持实体所有权追踪

### 6. 视觉创作 Agent 增强

- **局部重绘 (Inpainting)**：选区遮罩 + 重绘，归入工具区 + 二次确认
- **手绘板 (Drawing Board)**：草图 → AI 生图 + 画板尺寸选择器
- **图片快捷操作栏**：快捷编辑 + DIY 快捷指令 + AI 优化提示词
- **多图与重试**：统一三种生图模式的发送/重试逻辑，抽取 `MultiImagePromptTransformer`
- **统一生图请求格式**：前端 → 后端 → LLM 全链路 JSON 格式统一

### 7. 模型池策略引擎

- 独立组件改造（渐进式架构重构）
- 策略配置 UI + 调度预测可视化弹窗
- GlassSwitch 策略选择器 + 健康状态重置 UI
- `ModelListItem` 通用组件抽取

### 8. 配置市场 (海鲜市场)

- 可扩展类型注册表 `CONFIG_TYPE_REGISTRY`
- 水印面板、视觉创作设置集成市场 Tab
- `ConfigManagementDialogBase` 抽象 + Fork 自定义命名

### 9. 水印系统增强

- 纯图标水印（无文字）+ Figma 风格颜色选择器（含 Hex 输入）
- 编辑器布局优化：分节线、间距调整、分类简化
- 字体加载后测量与定位修复

### 10. Agent Switcher 迭代 (v5 → v11)

| 版本 | 特色 |
|------|------|
| v5 | Apple 极简风格 |
| v6 | 富背景 + 增强发光 |
| v7 | WebGL2 宇宙粒子网络 |
| v8 | 胶片卷轴滚动背景 |
| v9 | Linear 风格 + 飞入动画 |
| v10 | Apple 动画 + 彩虹发光边框 |
| v11 | 真实边缘辉光 + 隧道过渡 |

### 11. 开放平台 (Open Platform)

- 扁平 Tab 导航重构 + 渠道管理入口 + 统计 API
- 统一邮件渠道面板 + 多面板 tech-style 布局重设计

### 12. 桌面端 (Tauri)

- 新增缺陷管理模块
- 优雅关闭钩子 + `tokio::select!` SSE 流处理
- 修复 SSE 3x 订阅循环

### 13. UI/UX 改进

- 液态玻璃效果扩展（特效展示、工具卡片、群组卡片）
- 群组列表改为卡片网格 + 头像堆叠 + 热力图标 + Token 统计
- Golden Nebula 加载动画 + BlackHoleVortex（Perlin 噪声）
- 多个面板重设计：Manus 风格、macOS Control Center 风格

### 14. 质量与稳定性

- CI 测试分类优化，排除 Manual 测试
- SSE 解析器换行丢失修复 + JsonValueKind 安全检查
- DeepSeek reasoning 模式支持 + Session TTL 统一 3 天

---

## 二、未来方向

### 方向一：新手教程与引导系统

**目标**：降低使用门槛，让新用户 10 分钟内完成首个完整流程。

| 阶段 | 内容 | 说明 |
|------|------|------|
| 交互式引导 | 分步骤 Onboarding Tour | 首次登录自动触发，高亮关键区域，逐步引导完成「上传 PRD → 解读 → 提问 → 导出」全流程 |
| 场景化教程 | 按角色提供教程路径 | 产品经理路径、开发路径、测试路径、管理者路径，各角色只看与自己相关的功能 |
| 示例空间 | 内置 Demo 项目 | 预置真实 PRD 样本 + 已解析结果 + 示例对话，用户可直接体验而非从零开始 |
| 帮助中心 | 上下文感知帮助 | 根据当前页面和操作状态，动态推荐相关文档和视频教程 |
| 视频微课 | 每个功能 2 分钟短视频 | 嵌入功能旁的 "?" 图标，点击即看操作演示 |

### 方向二：PRD Agent 体验重构 — 产研团队角色化 Agent

**目标**：从"通用问答工具"升级为"产研团队 AI 协作平台"，每个角色拥有专属 Agent 技能，融入日常工作流。

| 角色 Agent | 核心技能 | 典型场景 |
|------------|----------|----------|
| **产品经理 Agent** | PRD 结构化解读、需求拆分为用户故事、竞品分析、优先级排序、版本规划建议 | PM 上传 PRD 后自动生成用户故事列表，标注依赖关系，建议迭代分期 |
| **架构师 Agent** | 技术方案评审、接口设计建议、非功能需求提取、技术风险识别 | 从 PRD 自动提取技术约束，生成 API 设计草案和架构决策记录 (ADR) |
| **开发者 Agent** | 需求澄清问答、代码片段生成、测试用例建议、工时预估辅助 | 开发者对某条需求提问，Agent 结合上下文给出实现建议和边界条件 |
| **测试 Agent** | 测试用例自动生成、边界值分析、验收标准提取、缺陷关联 | 从需求描述自动生成测试矩阵，结合缺陷模板直接创建缺陷单 |
| **项目经理 Agent** | 进度风险预警、阻塞依赖检测、站会摘要生成、里程碑追踪 | 聚合所有 Agent 活动数据，自动生成每日/每周项目状态报告 |
| **设计师 Agent** | 交互规范检查、设计稿与需求一致性比对、设计 Token 管理 | 上传设计稿后自动比对 PRD 中的 UI 描述，标注偏差项 |

**核心改造**：
- 统一 Agent 切换器支持角色切换，不同角色看到不同的技能面板
- Prompt Stages 按角色预置专属提示词链
- 对话上下文支持跨角色共享（如 PM 的需求拆分结果直接传递给开发者 Agent）

### 方向三：总裁面板 (Executive Dashboard)

> 详细设计文档：[design.executive-dashboard.md](./design.executive-dashboard.md)

**目标**：管理层一站式掌握全员 AI 使用情况和工作产出，推动 AI 融入组织工作流。

**五个核心 Tab**：

| Tab | 功能 | 说明 |
|-----|------|------|
| **全局概览** | 实时仪表盘 | 日活、对话数、Token、AI 渗透率、响应时间、缺陷效率 — 6 个 KPI 一屏看完 |
| **团队洞察** | 三级下钻 | 组织 → 团队 → 个人，每人一张 AI 使用画像卡片，含活跃度、Agent 分布、外部协作 |
| **Agent 使用** | 采纳度分析 | 各 Agent 采纳率、使用深度、功能热度排名、用户 × Agent 技能矩阵 |
| **成本中心** | Token 预算管理 | 按部门/Agent/模型三维成本分解，月度预算进度条 + 超支预警 + 优化建议 |
| **外部协作** | 第三方集成 | Claude Code session、Jira 任务、GitLab MR — 统一 Webhook 协议汇入 |

**配套周报 Agent**：定时任务自动聚合每个用户本周活动数据 → LLM 生成叙事性周报 → 存储 + 推送通知 → 总裁面板直接消费

### 方向四：知识库与组织记忆

**目标**：将散落在对话中的知识沉淀为组织资产，打破信息孤岛。

| 能力 | 说明 |
|------|------|
| 文档知识库 | 上传产品文档、技术文档、设计规范，Agent 自动索引并在对话中引用 |
| 对话知识沉淀 | 将高质量 Q&A 一键收录为知识条目，团队共享 |
| 智能检索 | 跨项目、跨文档的语义搜索，自动关联相关知识 |
| 知识图谱 | 自动构建需求 → 设计 → 代码 → 测试的链路追溯图 |

### 方向五：工作流自动化引擎

**目标**：将重复性产研流程自动化，减少人工流转。

| 能力 | 说明 |
|------|------|
| 流程编排器 | 可视化拖拽定义工作流（如：PRD 上传 → 自动解读 → 分配评审 → 生成用户故事） |
| 触发器机制 | 支持定时触发、事件触发（新 PRD 上传、缺陷状态变更）、Webhook 触发 |
| 跨 Agent 编排 | 多个 Agent 串联协作（PM Agent 输出 → 架构师 Agent 评审 → 开发者 Agent 拆解） |
| 审批节点 | 关键环节人工确认，AI 建议 + 人工决策的混合模式 |

### 方向六：多端体验统一与移动端

**目标**：随时随地访问，不受设备限制。

| 能力 | 说明 |
|------|------|
| 移动端适配 | 响应式布局 + PWA 支持，手机端可查看 PRD 解读结果和审批通知 |
| 桌面端增强 | Tauri 桌面端与 Web 端功能对齐，支持离线缓存和快捷键 |
| 通知统一 | 跨端消息推送（Web 通知 + 桌面端系统通知 + 邮件摘要 + 企微/钉钉/飞书集成） |

### 方向七：国际化与多语言

**目标**：支撑海外团队和多语言协作场景。

| 能力 | 说明 |
|------|------|
| i18n 基础设施 | 前端 + 后端双向国际化框架 |
| 多语言 PRD 解读 | 支持英文、日文等 PRD 文档解读，自动切换对话语言 |
| 翻译辅助 | PRD 内容一键翻译，保持术语一致性 |

### 方向八：企业级部署与安全合规

**目标**：满足大型企业的部署和安全需求。

| 能力 | 说明 |
|------|------|
| K8s 部署方案 | Helm Chart + 弹性伸缩 + 多副本高可用 |
| SSO 集成 | LDAP / SAML / OIDC 企业单点登录 |
| 数据安全 | 敏感信息脱敏、对话数据加密存储、审计日志完整链路 |
| 私有化部署 | 支持全离线部署，模型可对接企业私有 LLM |

---

## 三、下周优先级建议

| 优先级 | 方向 | 建议动作 |
|--------|------|----------|
| P0 | PRD Agent 体验重构 | 完成角色 Agent 技能矩阵设计，先落地产品经理 Agent 技能集 |
| P0 | 总裁面板 | 搭建数据采集层，实现全局概览仪表盘 MVP |
| P1 | 新手教程 | 实现交互式 Onboarding Tour，覆盖核心流程 |
| P1 | 知识库 | 完成文档上传 + 向量索引 + 对话引用 MVP |
| P2 | 工作流引擎 | 设计工作流编排协议，输出设计文档 |
| P2 | 移动端 | PWA 基础适配 + 响应式关键页面改造 |
