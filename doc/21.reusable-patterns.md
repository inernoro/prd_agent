# 可复用组件产品方案

> 从缺陷管理 Agent 沉淀的通用组件，可应用于其他业务模块。

---

## 一、软删除与回收站

### 设计理念

**"删除不是终点，而是暂存"**

用户误操作是不可避免的。传统的硬删除让数据一去不复返，造成不可逆的损失。软删除将"删除"重新定义为"移入回收站"，给用户后悔的机会。

### 核心功能

| 功能 | 说明 |
|------|------|
| 软删除 | 点击删除后数据进入回收站，原列表不再显示 |
| 回收站 | 独立入口查看已删除项，按删除时间倒序 |
| 恢复 | 一键还原到原位置，数据完整保留 |
| 永久删除 | 仅限回收站内操作，彻底清除数据 |

### 用户体验要点

- 删除按钮无需二次确认（因为可恢复）
- 回收站入口放置于页面右上角，图标为垃圾桶
- 恢复后跳转回原列表，toast 提示"已恢复"
- 永久删除需二次确认，文案强调"不可恢复"

### 扩展方向

1. **自动清理**：回收站数据保留 30 天，超期自动永久删除
2. **批量操作**：支持全选清空回收站
3. **搜索支持**：回收站内支持关键词搜索

---

## 二、文件夹分类

### 设计理念

**"让用户用自己的方式组织内容"**

系统预设的分类（如状态、优先级）是固定视角，但每个用户都有自己的整理习惯。文件夹让用户按项目、客户、主题等任意维度自由归类。

### 核心功能

| 功能 | 说明 |
|------|------|
| 创建文件夹 | 自定义名称、颜色、图标 |
| 移动归类 | 将条目拖入文件夹，或通过菜单移动 |
| 批量移动 | 多选后一次性归入同一文件夹 |
| 删除文件夹 | 文件夹删除后，内容自动移回"未分类" |

### 用户体验要点

- 文件夹显示在左侧边栏，支持拖拽排序
- "未分类"作为默认视图，显示不在任何文件夹中的条目
- 文件夹颜色用于视觉区分，色块显示在条目卡片上
- 空文件夹显示"暂无内容"引导文案

### 扩展方向

1. **嵌套文件夹**：支持多级目录结构
2. **智能文件夹**：基于规则自动归类（如"本周新增"）
3. **文件夹共享**：团队成员可见同一文件夹

---

## 三、空间隔离

### 设计理念

**"现在共享，未来可分"**

初期用户量小，所有数据共享可以促进协作。但随着团队扩展，数据隔离是必然需求。空间隔离机制在数据层预埋 `spaceId` 字段，当前统一为"默认空间"，未来可按团队拆分。

### 当前阶段

| 场景 | 行为 |
|------|------|
| 所有用户 | 共享同一空间，互相可见所有文件夹和内容 |
| spaceId 值 | `null` 或 `"default"`，等效处理 |

### 未来阶段

| 场景 | 行为 |
|------|------|
| 团队 A | 只能看到 `spaceId = "team-a"` 的数据 |
| 团队 B | 只能看到 `spaceId = "team-b"` 的数据 |
| 跨团队操作 | 系统拒绝，提示"无权限访问" |

### 迁移策略

1. 管理员创建新空间 `team-xxx`
2. 批量工具将指定文件夹迁移到新空间
3. 原文件夹的条目自动继承新 spaceId
4. 迁移完成后，团队成员只看到自己空间的数据

### 扩展方向

1. **空间管理后台**：创建/删除/重命名空间
2. **跨空间共享**：特定条目可"发布"到公共空间
3. **空间配额**：按空间设置存储/条目数量限制

---

## 组合应用示例

缺陷管理 Agent 组合使用三个组件：

```
用户视角:
├── 左侧边栏
│   ├── 📁 产品A缺陷 (3)
│   ├── 📁 产品B缺陷 (7)
│   └── 📂 未分类 (12)
├── 右上角
│   └── 🗑️ 回收站 (2)
└── 主内容区
    └── 缺陷卡片列表

数据结构:
DefectReport
├── 业务字段: title, content, status...
├── 软删除: isDeleted, deletedAt, deletedBy
└── 分类: folderId → DefectFolder.spaceId
```

---

## 技术备注

- 软删除字段：`isDeleted` (bool)、`deletedAt` (timestamp)、`deletedBy` (userId)
- 文件夹关联：条目通过 `folderId` 引用文件夹
- 空间隔离键：`spaceId` 字段，null 与 "default" 等效
- 列表查询默认过滤 `isDeleted = false`

---

*版本: 1.1 | 来源: 缺陷管理 Agent*
